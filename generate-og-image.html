<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>OG Image Generator</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400&family=DM+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
  body {
    font-family: sans-serif;
    padding: 40px;
    text-align: center;
  }
  canvas {
    border: 1px solid #ccc;
    margin: 20px auto;
    display: block;
  }
  button {
    padding: 12px 24px;
    font-size: 14px;
    cursor: pointer;
    background: #2d4a3e;
    color: white;
    border: none;
    border-radius: 4px;
  }
  button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  .status {
    margin: 20px;
    color: #666;
  }
</style>
</head>
<body>
  <h1>OG Image Generator for Slide Collage</h1>
  <div class="status" id="status">画像を読み込み中...</div>
  <canvas id="canvas"></canvas>
  <button id="downloadBtn" onclick="downloadImage()" disabled>Download OG Image (1200x630)</button>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    // OG image size
    canvas.width = 1200;
    canvas.height = 630;

    // Load background image
    const bgImage = new Image();
    bgImage.src = 'sample.png';

    bgImage.onload = () => {
      document.getElementById('status').textContent = '画像読み込み完了！フォント読み込み中...';
      document.fonts.ready.then(() => {
        drawOGImage();
        document.getElementById('status').textContent = '✓ 生成完了！ダウンロードできます';
        document.getElementById('downloadBtn').disabled = false;
      });
    };

    bgImage.onerror = () => {
      document.getElementById('status').textContent = '❌ エラー: sample.pngが見つかりません';
      document.getElementById('status').style.color = 'red';
    };

    function drawOGImage() {
      // Draw background image (cover style)
      const imgRatio = bgImage.width / bgImage.height;
      const canvasRatio = canvas.width / canvas.height;

      let drawWidth, drawHeight, offsetX, offsetY;

      if (imgRatio > canvasRatio) {
        // Image is wider
        drawHeight = canvas.height;
        drawWidth = drawHeight * imgRatio;
        offsetX = (canvas.width - drawWidth) / 2;
        offsetY = 0;
      } else {
        // Image is taller
        drawWidth = canvas.width;
        drawHeight = drawWidth / imgRatio;
        offsetX = 0;
        offsetY = (canvas.height - drawHeight) / 2;
      }

      ctx.drawImage(bgImage, offsetX, offsetY, drawWidth, drawHeight);

      // Black gradient overlay (bottom to top)
      const gradient = ctx.createLinearGradient(0, canvas.height, 0, 0);
      gradient.addColorStop(0, 'rgba(0, 0, 0, 0.8)');
      gradient.addColorStop(0.5, 'rgba(0, 0, 0, 0.4)');
      gradient.addColorStop(1, 'rgba(0, 0, 0, 0)');

      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Title - Slide Collage
      ctx.fillStyle = '#ffffff';
      ctx.font = '300 110px "Cormorant Garamond", serif';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText('Slide Collage', canvas.width / 2, canvas.height / 2 + 30);

      // Subtitle - Portfolio Layout Generator
      ctx.fillStyle = 'rgba(255, 255, 255, 0.85)';
      ctx.font = '300 32px "DM Mono", monospace';
      ctx.fillText('Portfolio Layout Generator', canvas.width / 2, canvas.height / 2 + 100);
    }

    function downloadImage() {
      const link = document.createElement('a');
      link.download = 'og-image.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    }
  </script>
</body>
</html>
